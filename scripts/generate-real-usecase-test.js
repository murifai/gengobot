const XLSX = require('xlsx');
const path = require('path');

// Real Use Case Task-Based Test
const realUseCaseData = {
  // Sheet 1: Onboarding & Auth Journey
  'Onboarding Journey': [
    {
      TaskID: 'UC-ONB-001',
      Scenario: 'User Baru Mendaftar',
      Task: 'Buka landing page, klik "Mulai Gratis", daftar dengan email, verifikasi email, selesaikan onboarding (pilih level JLPT, tujuan belajar)',
      ExpectedFlow: 'Landing → Register → Email Verify → Onboarding → Dashboard',
      TargetTime: '5 min',
      ActualTime: '',
      Success: '',
      Errors: '',
      FrictionPoints: '',
      UserFeedback: '',
    },
    {
      TaskID: 'UC-ONB-002',
      Scenario: 'User Baru via Google',
      Task: 'Daftar menggunakan akun Google, selesaikan onboarding',
      ExpectedFlow: 'Landing → Google OAuth → Onboarding → Dashboard',
      TargetTime: '3 min',
      ActualTime: '',
      Success: '',
      Errors: '',
      FrictionPoints: '',
      UserFeedback: '',
    },
    {
      TaskID: 'UC-ONB-003',
      Scenario: 'User Lupa Password',
      Task: 'Klik "Lupa Password", masukkan email, buka email reset, buat password baru, login',
      ExpectedFlow: 'Login → Forgot → Email → Reset → Login → Dashboard',
      TargetTime: '3 min',
      ActualTime: '',
      Success: '',
      Errors: '',
      FrictionPoints: '',
      UserFeedback: '',
    },
    {
      TaskID: 'UC-ONB-004',
      Scenario: 'User Returning Login',
      Task: 'Login dengan email dan password yang sudah ada',
      ExpectedFlow: 'Login → Dashboard',
      TargetTime: '30 sec',
      ActualTime: '',
      Success: '',
      Errors: '',
      FrictionPoints: '',
      UserFeedback: '',
    },
    {
      TaskID: 'UC-ONB-005',
      Scenario: 'Skip Onboarding',
      Task: 'Daftar akun baru, skip semua pertanyaan onboarding, langsung ke dashboard',
      ExpectedFlow: 'Register → Skip → Dashboard',
      TargetTime: '2 min',
      ActualTime: '',
      Success: '',
      Errors: '',
      FrictionPoints: '',
      UserFeedback: '',
    },
  ],

  // Sheet 2: Character & Free Chat
  'Character & Chat': [
    {
      TaskID: 'UC-CHR-001',
      Scenario: 'Buat Karakter Baru',
      Task: 'Buka menu Karakter, klik "Buat Karakter Baru", isi nama, deskripsi, personality, upload avatar, simpan',
      ExpectedFlow: 'Profile → Karakter → Create → Form → Save',
      TargetTime: '3 min',
      ActualTime: '',
      Success: '',
      Errors: '',
      FrictionPoints: '',
      UserFeedback: '',
    },
    {
      TaskID: 'UC-CHR-002',
      Scenario: 'Chat dengan Karakter Custom',
      Task: 'Buka Ngobrol Bebas, pilih karakter yang baru dibuat, mulai percakapan dengan mengetik pesan',
      ExpectedFlow: 'Kaiwa → Bebas → Select Character → Chat',
      TargetTime: '2 min',
      ActualTime: '',
      Success: '',
      Errors: '',
      FrictionPoints: '',
      UserFeedback: '',
    },
    {
      TaskID: 'UC-CHR-003',
      Scenario: 'Kirim Pesan Suara ke Karakter',
      Task: 'Dalam chat, tekan tombol mic, rekam pesan dalam bahasa Jepang, kirim, dengarkan balasan AI',
      ExpectedFlow: 'Chat → Record → Send → Receive Audio',
      TargetTime: '1 min',
      ActualTime: '',
      Success: '',
      Errors: '',
      FrictionPoints: '',
      UserFeedback: '',
    },
    {
      TaskID: 'UC-CHR-004',
      Scenario: 'Edit Karakter yang Ada',
      Task: 'Buka profil, pilih karakter, edit personality/deskripsi, simpan perubahan',
      ExpectedFlow: 'Profile → Karakter → Edit → Save',
      TargetTime: '2 min',
      ActualTime: '',
      Success: '',
      Errors: '',
      FrictionPoints: '',
      UserFeedback: '',
    },
    {
      TaskID: 'UC-CHR-005',
      Scenario: 'Hapus Karakter',
      Task: 'Buka profil, pilih karakter, klik hapus, konfirmasi penghapusan',
      ExpectedFlow: 'Profile → Karakter → Delete → Confirm',
      TargetTime: '1 min',
      ActualTime: '',
      Success: '',
      Errors: '',
      FrictionPoints: '',
      UserFeedback: '',
    },
    {
      TaskID: 'UC-CHR-006',
      Scenario: 'Chat Panjang dengan Karakter',
      Task: 'Lakukan percakapan 10+ pesan bolak-balik dengan karakter, gunakan mix text dan voice',
      ExpectedFlow: 'Chat → Multiple exchanges',
      TargetTime: '10 min',
      ActualTime: '',
      Success: '',
      Errors: '',
      FrictionPoints: '',
      UserFeedback: '',
    },
    {
      TaskID: 'UC-CHR-007',
      Scenario: 'Minta Hint dalam Chat',
      Task: 'Saat stuck dalam percakapan, gunakan fitur hint untuk mendapat saran respons',
      ExpectedFlow: 'Chat → Hint Button → View Suggestion',
      TargetTime: '30 sec',
      ActualTime: '',
      Success: '',
      Errors: '',
      FrictionPoints: '',
      UserFeedback: '',
    },
  ],

  // Sheet 3: Roleplay Scenarios
  'Roleplay Journey': [
    {
      TaskID: 'UC-RP-001',
      Scenario: 'Pertama Kali Roleplay',
      Task: 'Buka Kaiwa, pilih Roleplay, browse task, pilih task N5 "Memesan di Restoran", baca pre-study, mulai latihan',
      ExpectedFlow: 'Kaiwa → Roleplay → Browse → Select → Pre-study → Start',
      TargetTime: '5 min',
      ActualTime: '',
      Success: '',
      Errors: '',
      FrictionPoints: '',
      UserFeedback: '',
    },
    {
      TaskID: 'UC-RP-002',
      Scenario: 'Selesaikan Satu Roleplay',
      Task: 'Mulai roleplay, selesaikan semua objectives, lihat feedback dan skor',
      ExpectedFlow: 'Start → Complete Objectives → End → View Results',
      TargetTime: '15 min',
      ActualTime: '',
      Success: '',
      Errors: '',
      FrictionPoints: '',
      UserFeedback: '',
    },
    {
      TaskID: 'UC-RP-003',
      Scenario: 'Roleplay dengan Voice',
      Task: 'Dalam roleplay, gunakan voice input untuk semua respons, dengarkan audio AI',
      ExpectedFlow: 'Roleplay → Voice Record → Send → Listen Response',
      TargetTime: '10 min',
      ActualTime: '',
      Success: '',
      Errors: '',
      FrictionPoints: '',
      UserFeedback: '',
    },
    {
      TaskID: 'UC-RP-004',
      Scenario: 'Keluar Roleplay Tengah Jalan',
      Task: 'Mulai roleplay, setelah beberapa pesan, keluar/quit session, konfirmasi keluar',
      ExpectedFlow: 'Roleplay → Exit → Confirm → Back to List',
      TargetTime: '2 min',
      ActualTime: '',
      Success: '',
      Errors: '',
      FrictionPoints: '',
      UserFeedback: '',
    },
    {
      TaskID: 'UC-RP-005',
      Scenario: 'Cari Task dengan Filter',
      Task: 'Di halaman roleplay, filter berdasarkan level N4, kategori "Travel", pilih salah satu task',
      ExpectedFlow: 'Roleplay List → Filter Level → Filter Category → Select',
      TargetTime: '1 min',
      ActualTime: '',
      Success: '',
      Errors: '',
      FrictionPoints: '',
      UserFeedback: '',
    },
    {
      TaskID: 'UC-RP-006',
      Scenario: 'Review Hasil Roleplay Lama',
      Task: 'Buka history/recent activity, temukan roleplay yang sudah selesai, lihat detail hasil dan feedback',
      ExpectedFlow: 'Dashboard/History → Find Past Session → View Details',
      TargetTime: '2 min',
      ActualTime: '',
      Success: '',
      Errors: '',
      FrictionPoints: '',
      UserFeedback: '',
    },
    {
      TaskID: 'UC-RP-007',
      Scenario: 'Retry Roleplay yang Gagal',
      Task: 'Temukan roleplay dengan skor rendah, mulai ulang task yang sama, coba perbaiki skor',
      ExpectedFlow: 'History → Find Low Score → Retry → Complete',
      TargetTime: '15 min',
      ActualTime: '',
      Success: '',
      Errors: '',
      FrictionPoints: '',
      UserFeedback: '',
    },
  ],

  // Sheet 4: Drill & Flashcard
  'Drill & Flashcard': [
    {
      TaskID: 'UC-DRL-001',
      Scenario: 'Buat Deck Pertama',
      Task: 'Buka Drill, klik "Buat Deck Baru", beri nama "Kosakata N5", tambah 5 kartu (front: kanji, back: arti), simpan',
      ExpectedFlow: 'Drill → Create Deck → Add Cards → Save',
      TargetTime: '5 min',
      ActualTime: '',
      Success: '',
      Errors: '',
      FrictionPoints: '',
      UserFeedback: '',
    },
    {
      TaskID: 'UC-DRL-002',
      Scenario: 'Study Session Lengkap',
      Task: 'Pilih deck, mulai study, review 10 kartu, beri rating untuk setiap kartu, lihat hasil session',
      ExpectedFlow: 'Deck → Study → Rate Cards → Complete → View Stats',
      TargetTime: '5 min',
      ActualTime: '',
      Success: '',
      Errors: '',
      FrictionPoints: '',
      UserFeedback: '',
    },
    {
      TaskID: 'UC-DRL-003',
      Scenario: 'Edit Kartu dalam Deck',
      Task: 'Buka deck, pilih kartu yang salah, edit konten front/back, simpan perubahan',
      ExpectedFlow: 'Deck → Cards List → Edit Card → Save',
      TargetTime: '2 min',
      ActualTime: '',
      Success: '',
      Errors: '',
      FrictionPoints: '',
      UserFeedback: '',
    },
    {
      TaskID: 'UC-DRL-004',
      Scenario: 'Hapus Kartu dari Deck',
      Task: 'Buka deck, pilih kartu yang tidak dibutuhkan, hapus kartu, konfirmasi',
      ExpectedFlow: 'Deck → Cards → Delete → Confirm',
      TargetTime: '1 min',
      ActualTime: '',
      Success: '',
      Errors: '',
      FrictionPoints: '',
      UserFeedback: '',
    },
    {
      TaskID: 'UC-DRL-005',
      Scenario: 'Cari Public Deck',
      Task: 'Buka explore/public decks, cari deck "JLPT N5 Vocabulary", lihat preview, favorite deck',
      ExpectedFlow: 'Drill → Explore → Search → Preview → Favorite',
      TargetTime: '2 min',
      ActualTime: '',
      Success: '',
      Errors: '',
      FrictionPoints: '',
      UserFeedback: '',
    },
    {
      TaskID: 'UC-DRL-006',
      Scenario: 'Study dari Favorited Deck',
      Task: 'Buka favorited decks, pilih deck publik yang di-favorite, mulai study session',
      ExpectedFlow: 'Drill → Favorites → Select → Study',
      TargetTime: '3 min',
      ActualTime: '',
      Success: '',
      Errors: '',
      FrictionPoints: '',
      UserFeedback: '',
    },
    {
      TaskID: 'UC-DRL-007',
      Scenario: 'Share Deck via Link',
      Task: 'Buka deck milik sendiri, klik share, copy link, paste di tempat lain untuk test',
      ExpectedFlow: 'Deck → Share → Copy Link → Verify',
      TargetTime: '1 min',
      ActualTime: '',
      Success: '',
      Errors: '',
      FrictionPoints: '',
      UserFeedback: '',
    },
    {
      TaskID: 'UC-DRL-008',
      Scenario: 'Import Deck dari Link',
      Task: 'Buka link deck yang di-share, lihat preview, tambahkan ke favorit atau copy ke deck sendiri',
      ExpectedFlow: 'Open Link → Preview → Add/Copy',
      TargetTime: '2 min',
      ActualTime: '',
      Success: '',
      Errors: '',
      FrictionPoints: '',
      UserFeedback: '',
    },
    {
      TaskID: 'UC-DRL-009',
      Scenario: 'Lihat Statistik Belajar',
      Task: 'Buka deck, lihat statistik (cards learned, retention rate, streak), pahami progress',
      ExpectedFlow: 'Deck → Stats → Understand Progress',
      TargetTime: '1 min',
      ActualTime: '',
      Success: '',
      Errors: '',
      FrictionPoints: '',
      UserFeedback: '',
    },
    {
      TaskID: 'UC-DRL-010',
      Scenario: 'Hapus Deck',
      Task: 'Pilih deck yang tidak dibutuhkan, hapus deck, konfirmasi penghapusan',
      ExpectedFlow: 'Deck → Delete → Confirm',
      TargetTime: '1 min',
      ActualTime: '',
      Success: '',
      Errors: '',
      FrictionPoints: '',
      UserFeedback: '',
    },
  ],

  // Sheet 5: Subscription & Payment
  'Subscription & Payment': [
    {
      TaskID: 'UC-SUB-001',
      Scenario: 'Lihat Paket Langganan',
      Task: 'Dari dashboard, buka halaman pricing/langganan, bandingkan fitur Free vs Basic vs Pro',
      ExpectedFlow: 'Dashboard → Pricing → Compare Plans',
      TargetTime: '2 min',
      ActualTime: '',
      Success: '',
      Errors: '',
      FrictionPoints: '',
      UserFeedback: '',
    },
    {
      TaskID: 'UC-SUB-002',
      Scenario: 'Upgrade Free ke Basic',
      Task: 'Pilih paket Basic, klik upgrade, pilih metode pembayaran, selesaikan pembayaran via Midtrans',
      ExpectedFlow: 'Pricing → Select Basic → Payment → Midtrans → Confirm',
      TargetTime: '5 min',
      ActualTime: '',
      Success: '',
      Errors: '',
      FrictionPoints: '',
      UserFeedback: '',
    },
    {
      TaskID: 'UC-SUB-003',
      Scenario: 'Upgrade Basic ke Pro',
      Task: 'Dari akun Basic, upgrade ke Pro, bayar selisih harga, verifikasi fitur Pro aktif',
      ExpectedFlow: 'Settings → Upgrade → Payment → Verify Pro Features',
      TargetTime: '5 min',
      ActualTime: '',
      Success: '',
      Errors: '',
      FrictionPoints: '',
      UserFeedback: '',
    },
    {
      TaskID: 'UC-SUB-004',
      Scenario: 'Downgrade Pro ke Basic',
      Task: 'Dari akun Pro, downgrade ke Basic, pahami kapan berlaku, konfirmasi',
      ExpectedFlow: 'Settings → Subscription → Downgrade → Confirm',
      TargetTime: '3 min',
      ActualTime: '',
      Success: '',
      Errors: '',
      FrictionPoints: '',
      UserFeedback: '',
    },
    {
      TaskID: 'UC-SUB-005',
      Scenario: 'Cancel Subscription',
      Task: 'Buka settings subscription, klik cancel, pilih alasan, konfirmasi pembatalan',
      ExpectedFlow: 'Settings → Subscription → Cancel → Reason → Confirm',
      TargetTime: '3 min',
      ActualTime: '',
      Success: '',
      Errors: '',
      FrictionPoints: '',
      UserFeedback: '',
    },
    {
      TaskID: 'UC-SUB-006',
      Scenario: 'Redeem Voucher Code',
      Task: 'Dapatkan voucher code, buka halaman redeem, masukkan kode, apply, verifikasi credit/benefit',
      ExpectedFlow: 'Settings → Redeem → Enter Code → Apply → Verify',
      TargetTime: '2 min',
      ActualTime: '',
      Success: '',
      Errors: '',
      FrictionPoints: '',
      UserFeedback: '',
    },
    {
      TaskID: 'UC-SUB-007',
      Scenario: 'Cek Credit Balance',
      Task: 'Lihat sisa credit di dashboard/header, pahami berapa credit tersisa untuk Kaiwa',
      ExpectedFlow: 'Dashboard/Header → View Credits',
      TargetTime: '30 sec',
      ActualTime: '',
      Success: '',
      Errors: '',
      FrictionPoints: '',
      UserFeedback: '',
    },
    {
      TaskID: 'UC-SUB-008',
      Scenario: 'Credit Habis saat Kaiwa',
      Task: 'Coba mulai Kaiwa dengan credit 0, lihat pesan error, temukan cara upgrade/beli credit',
      ExpectedFlow: 'Kaiwa → No Credit Error → Find Upgrade Path',
      TargetTime: '2 min',
      ActualTime: '',
      Success: '',
      Errors: '',
      FrictionPoints: '',
      UserFeedback: '',
    },
    {
      TaskID: 'UC-SUB-009',
      Scenario: 'Lihat Payment History',
      Task: 'Buka pengaturan akun, temukan riwayat pembayaran, lihat detail transaksi terakhir',
      ExpectedFlow: 'Settings → Payment History → View Details',
      TargetTime: '1 min',
      ActualTime: '',
      Success: '',
      Errors: '',
      FrictionPoints: '',
      UserFeedback: '',
    },
    {
      TaskID: 'UC-SUB-010',
      Scenario: 'Pembayaran Gagal',
      Task: 'Simulasi pembayaran gagal (batal di Midtrans), lihat error handling, coba lagi',
      ExpectedFlow: 'Payment → Cancel → Error → Retry',
      TargetTime: '3 min',
      ActualTime: '',
      Success: '',
      Errors: '',
      FrictionPoints: '',
      UserFeedback: '',
    },
  ],

  // Sheet 6: Profile & Settings
  'Profile & Settings': [
    {
      TaskID: 'UC-PRF-001',
      Scenario: 'Edit Profil Lengkap',
      Task: 'Buka profil, edit nama, bio, upload foto baru, simpan perubahan',
      ExpectedFlow: 'Profile → Edit → Fill Form → Upload Photo → Save',
      TargetTime: '3 min',
      ActualTime: '',
      Success: '',
      Errors: '',
      FrictionPoints: '',
      UserFeedback: '',
    },
    {
      TaskID: 'UC-PRF-002',
      Scenario: 'Ganti Password',
      Task: 'Buka settings, pilih ganti password, masukkan password lama dan baru, simpan',
      ExpectedFlow: 'Settings → Security → Change Password → Save',
      TargetTime: '2 min',
      ActualTime: '',
      Success: '',
      Errors: '',
      FrictionPoints: '',
      UserFeedback: '',
    },
    {
      TaskID: 'UC-PRF-003',
      Scenario: 'Ubah JLPT Level',
      Task: 'Buka settings, ubah target JLPT level dari N5 ke N4, simpan',
      ExpectedFlow: 'Settings → Learning → Change Level → Save',
      TargetTime: '1 min',
      ActualTime: '',
      Success: '',
      Errors: '',
      FrictionPoints: '',
      UserFeedback: '',
    },
    {
      TaskID: 'UC-PRF-004',
      Scenario: 'Toggle Dark Mode',
      Task: 'Buka settings, temukan tema/appearance, switch ke dark mode, verifikasi perubahan',
      ExpectedFlow: 'Settings → Appearance → Dark Mode → Verify',
      TargetTime: '30 sec',
      ActualTime: '',
      Success: '',
      Errors: '',
      FrictionPoints: '',
      UserFeedback: '',
    },
    {
      TaskID: 'UC-PRF-005',
      Scenario: 'Atur Notifikasi',
      Task: 'Buka settings notifikasi, toggle on/off reminder belajar, simpan',
      ExpectedFlow: 'Settings → Notifications → Toggle → Save',
      TargetTime: '1 min',
      ActualTime: '',
      Success: '',
      Errors: '',
      FrictionPoints: '',
      UserFeedback: '',
    },
    {
      TaskID: 'UC-PRF-006',
      Scenario: 'Lihat Learning Stats',
      Task: 'Buka dashboard/profil, lihat statistik belajar (streak, total sessions, progress)',
      ExpectedFlow: 'Dashboard → View Stats',
      TargetTime: '1 min',
      ActualTime: '',
      Success: '',
      Errors: '',
      FrictionPoints: '',
      UserFeedback: '',
    },
    {
      TaskID: 'UC-PRF-007',
      Scenario: 'Logout dan Login Ulang',
      Task: 'Logout dari akun, login kembali, verifikasi semua data masih ada',
      ExpectedFlow: 'Logout → Login → Verify Data',
      TargetTime: '2 min',
      ActualTime: '',
      Success: '',
      Errors: '',
      FrictionPoints: '',
      UserFeedback: '',
    },
    {
      TaskID: 'UC-PRF-008',
      Scenario: 'Hapus Akun',
      Task: 'Buka settings, temukan opsi hapus akun, baca warning, konfirmasi (jangan benar-benar hapus jika test)',
      ExpectedFlow: 'Settings → Delete Account → Read Warning → (Cancel)',
      TargetTime: '2 min',
      ActualTime: '',
      Success: '',
      Errors: '',
      FrictionPoints: '',
      UserFeedback: '',
    },
  ],

  // Sheet 7: Cross-Feature Journeys
  'Cross-Feature Journey': [
    {
      TaskID: 'UC-XFT-001',
      Scenario: 'New User Complete Journey',
      Task: 'Daftar baru → Onboarding → Coba roleplay gratis → Buat karakter → Chat → Buat deck → Study',
      ExpectedFlow: 'Full onboarding to first meaningful activity',
      TargetTime: '20 min',
      ActualTime: '',
      Success: '',
      Errors: '',
      FrictionPoints: '',
      UserFeedback: '',
    },
    {
      TaskID: 'UC-XFT-002',
      Scenario: 'Daily Learning Routine',
      Task: 'Login → Cek dashboard → Study due cards → Lakukan 1 roleplay → Logout',
      ExpectedFlow: 'Typical daily usage pattern',
      TargetTime: '15 min',
      ActualTime: '',
      Success: '',
      Errors: '',
      FrictionPoints: '',
      UserFeedback: '',
    },
    {
      TaskID: 'UC-XFT-003',
      Scenario: 'Upgrade lalu Maximize',
      Task: 'Upgrade ke Basic → Langsung coba fitur premium → Buat karakter unlimited → Extended roleplay',
      ExpectedFlow: 'Post-upgrade feature exploration',
      TargetTime: '15 min',
      ActualTime: '',
      Success: '',
      Errors: '',
      FrictionPoints: '',
      UserFeedback: '',
    },
    {
      TaskID: 'UC-XFT-004',
      Scenario: 'Social Learning',
      Task: 'Cari public deck → Favorite → Study → Share deck sendiri → Copy link',
      ExpectedFlow: 'Social/sharing features',
      TargetTime: '10 min',
      ActualTime: '',
      Success: '',
      Errors: '',
      FrictionPoints: '',
      UserFeedback: '',
    },
    {
      TaskID: 'UC-XFT-005',
      Scenario: 'Error Recovery Journey',
      Task: 'Coba aksi yang gagal (no credit/network error) → Understand error → Find solution → Complete action',
      ExpectedFlow: 'Error to resolution',
      TargetTime: '5 min',
      ActualTime: '',
      Success: '',
      Errors: '',
      FrictionPoints: '',
      UserFeedback: '',
    },
    {
      TaskID: 'UC-XFT-006',
      Scenario: 'Mobile-only Experience',
      Task: 'Gunakan app 100% di mobile → Semua fitur core → Roleplay → Drill → Chat → Payment',
      ExpectedFlow: 'Complete mobile journey',
      TargetTime: '30 min',
      ActualTime: '',
      Success: '',
      Errors: '',
      FrictionPoints: '',
      UserFeedback: '',
    },
    {
      TaskID: 'UC-XFT-007',
      Scenario: 'Power User Session',
      Task: 'Study 50 cards → 3 roleplay sessions → Create 2 karakter → Edit deck → Check all stats',
      ExpectedFlow: 'Intensive usage session',
      TargetTime: '45 min',
      ActualTime: '',
      Success: '',
      Errors: '',
      FrictionPoints: '',
      UserFeedback: '',
    },
    {
      TaskID: 'UC-XFT-008',
      Scenario: 'First Week Journey',
      Task: 'Day 1-7 usage: onboard, explore, subscribe, build habits, return daily',
      ExpectedFlow: 'First week retention pattern',
      TargetTime: '7 days',
      ActualTime: '',
      Success: '',
      Errors: '',
      FrictionPoints: '',
      UserFeedback: '',
    },
  ],

  // Sheet 8: Edge Cases & Error Handling
  'Edge Cases': [
    {
      TaskID: 'UC-ERR-001',
      Scenario: 'Slow Network',
      Task: 'Dengan koneksi lambat (3G), coba semua fitur utama - apakah ada timeout, loading state, retry?',
      ExpectedFlow: 'All features with slow network',
      TargetTime: '15 min',
      ActualTime: '',
      Success: '',
      Errors: '',
      FrictionPoints: '',
      UserFeedback: '',
    },
    {
      TaskID: 'UC-ERR-002',
      Scenario: 'Offline Mode',
      Task: 'Matikan internet, coba akses app, lihat offline message, nyalakan kembali, verifikasi recovery',
      ExpectedFlow: 'Offline → Online recovery',
      TargetTime: '3 min',
      ActualTime: '',
      Success: '',
      Errors: '',
      FrictionPoints: '',
      UserFeedback: '',
    },
    {
      TaskID: 'UC-ERR-003',
      Scenario: 'Session Timeout',
      Task: 'Biarkan app idle 30+ menit, coba lakukan aksi, lihat handling session expired',
      ExpectedFlow: 'Idle → Action → Session handling',
      TargetTime: '35 min',
      ActualTime: '',
      Success: '',
      Errors: '',
      FrictionPoints: '',
      UserFeedback: '',
    },
    {
      TaskID: 'UC-ERR-004',
      Scenario: 'Invalid Input',
      Task: 'Di berbagai form, masukkan input invalid (email salah, password pendek, special chars), lihat validasi',
      ExpectedFlow: 'Various forms → Invalid input → Error messages',
      TargetTime: '10 min',
      ActualTime: '',
      Success: '',
      Errors: '',
      FrictionPoints: '',
      UserFeedback: '',
    },
    {
      TaskID: 'UC-ERR-005',
      Scenario: 'Browser Back Button',
      Task: 'Gunakan browser back button di berbagai halaman, pastikan navigasi konsisten dan tidak break',
      ExpectedFlow: 'Various pages → Back button → Verify state',
      TargetTime: '5 min',
      ActualTime: '',
      Success: '',
      Errors: '',
      FrictionPoints: '',
      UserFeedback: '',
    },
    {
      TaskID: 'UC-ERR-006',
      Scenario: 'Refresh During Action',
      Task: 'Refresh halaman saat di tengah form/upload/payment, lihat handling dan recovery',
      ExpectedFlow: 'Mid-action → Refresh → Recovery',
      TargetTime: '5 min',
      ActualTime: '',
      Success: '',
      Errors: '',
      FrictionPoints: '',
      UserFeedback: '',
    },
    {
      TaskID: 'UC-ERR-007',
      Scenario: 'Concurrent Sessions',
      Task: 'Login di 2 browser/device berbeda, lakukan aksi di keduanya, lihat sync dan conflicts',
      ExpectedFlow: 'Multi-device → Concurrent actions → Sync',
      TargetTime: '10 min',
      ActualTime: '',
      Success: '',
      Errors: '',
      FrictionPoints: '',
      UserFeedback: '',
    },
    {
      TaskID: 'UC-ERR-008',
      Scenario: 'Large Content',
      Task: 'Buat deck dengan 100+ kartu, character dengan deskripsi sangat panjang, lihat performance',
      ExpectedFlow: 'Large data → Performance check',
      TargetTime: '15 min',
      ActualTime: '',
      Success: '',
      Errors: '',
      FrictionPoints: '',
      UserFeedback: '',
    },
  ],

  // Sheet 9: Mobile-Specific
  'Mobile Specific': [
    {
      TaskID: 'UC-MOB-001',
      Scenario: 'Touch Navigation',
      Task: 'Navigasi semua menu dengan touch, pastikan semua touchable area cukup besar',
      ExpectedFlow: 'All navigation via touch',
      TargetTime: '5 min',
      ActualTime: '',
      Success: '',
      Errors: '',
      FrictionPoints: '',
      UserFeedback: '',
    },
    {
      TaskID: 'UC-MOB-002',
      Scenario: 'Swipe Flashcard',
      Task: 'Study flashcard dengan swipe gesture untuk reveal dan rating',
      ExpectedFlow: 'Drill → Swipe interactions',
      TargetTime: '3 min',
      ActualTime: '',
      Success: '',
      Errors: '',
      FrictionPoints: '',
      UserFeedback: '',
    },
    {
      TaskID: 'UC-MOB-003',
      Scenario: 'Keyboard Handling',
      Task: 'Isi form di mobile, pastikan keyboard tidak block input dan submit button',
      ExpectedFlow: 'Form → Keyboard → Submit visible',
      TargetTime: '3 min',
      ActualTime: '',
      Success: '',
      Errors: '',
      FrictionPoints: '',
      UserFeedback: '',
    },
    {
      TaskID: 'UC-MOB-004',
      Scenario: 'Voice Recording Mobile',
      Task: 'Rekam voice message di mobile, pastikan permission, recording indicator, dan playback work',
      ExpectedFlow: 'Chat → Voice → Record → Send → Play',
      TargetTime: '3 min',
      ActualTime: '',
      Success: '',
      Errors: '',
      FrictionPoints: '',
      UserFeedback: '',
    },
    {
      TaskID: 'UC-MOB-005',
      Scenario: 'Portrait vs Landscape',
      Task: 'Gunakan app di portrait dan landscape, pastikan layout responsive',
      ExpectedFlow: 'Rotate device → Check layout',
      TargetTime: '5 min',
      ActualTime: '',
      Success: '',
      Errors: '',
      FrictionPoints: '',
      UserFeedback: '',
    },
    {
      TaskID: 'UC-MOB-006',
      Scenario: 'Payment on Mobile',
      Task: 'Selesaikan full payment flow di mobile, Midtrans popup, konfirmasi',
      ExpectedFlow: 'Mobile → Pricing → Payment → Midtrans → Done',
      TargetTime: '5 min',
      ActualTime: '',
      Success: '',
      Errors: '',
      FrictionPoints: '',
      UserFeedback: '',
    },
    {
      TaskID: 'UC-MOB-007',
      Scenario: 'Bottom Nav Usage',
      Task: 'Gunakan bottom navigation untuk pindah antar section utama, pastikan smooth dan intuitive',
      ExpectedFlow: 'Bottom nav → All sections',
      TargetTime: '3 min',
      ActualTime: '',
      Success: '',
      Errors: '',
      FrictionPoints: '',
      UserFeedback: '',
    },
    {
      TaskID: 'UC-MOB-008',
      Scenario: 'Pull to Refresh',
      Task: 'Di halaman list (decks, tasks), pull to refresh, pastikan data update',
      ExpectedFlow: 'List → Pull → Refresh → Updated data',
      TargetTime: '2 min',
      ActualTime: '',
      Success: '',
      Errors: '',
      FrictionPoints: '',
      UserFeedback: '',
    },
  ],

  // Sheet 10: Tester Summary
  'Tester Summary': [
    { Field: 'Tester Name', Value: '' },
    { Field: 'Test Date', Value: '' },
    { Field: 'Device Used', Value: '' },
    { Field: 'Browser/OS', Value: '' },
    { Field: 'User Segment', Value: '(New User / Returning / Power User)' },
    { Field: '---', Value: '---' },
    { Field: 'Total Tasks Attempted', Value: '' },
    { Field: 'Tasks Completed Successfully', Value: '' },
    { Field: 'Tasks Failed', Value: '' },
    { Field: 'Success Rate', Value: '' },
    { Field: '---', Value: '---' },
    { Field: 'Top 3 Friction Points', Value: '' },
    { Field: '1.', Value: '' },
    { Field: '2.', Value: '' },
    { Field: '3.', Value: '' },
    { Field: '---', Value: '---' },
    { Field: 'Top 3 Positive Experiences', Value: '' },
    { Field: '1.', Value: '' },
    { Field: '2.', Value: '' },
    { Field: '3.', Value: '' },
    { Field: '---', Value: '---' },
    { Field: 'Overall UX Score (1-10)', Value: '' },
    { Field: 'Would Recommend (1-10)', Value: '' },
    { Field: 'General Comments', Value: '' },
  ],
};

// Create workbook
const wb = XLSX.utils.book_new();

Object.keys(realUseCaseData).forEach(sheetName => {
  const ws = XLSX.utils.json_to_sheet(realUseCaseData[sheetName]);
  ws['!cols'] = [
    { wch: 14 },
    { wch: 30 },
    { wch: 80 },
    { wch: 50 },
    { wch: 12 },
    { wch: 12 },
    { wch: 10 },
    { wch: 30 },
    { wch: 35 },
    { wch: 40 },
  ];
  XLSX.utils.book_append_sheet(wb, ws, sheetName.substring(0, 31));
});

const outputPath = path.join(__dirname, '..', 'docs', 'testing', 'Gengobot_Real_UseCase_Test.xlsx');
XLSX.writeFile(wb, outputPath);
console.log('Created: ' + outputPath);
console.log('Total Sheets: ' + Object.keys(realUseCaseData).length);
console.log(
  'Total Use Cases: ' + Object.values(realUseCaseData).reduce((sum, arr) => sum + arr.length, 0)
);
